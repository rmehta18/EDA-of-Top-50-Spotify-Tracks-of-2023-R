---
title: "Project 1: Spotify Popularity Analysis"
author: "Guarang and Rithik"
date: "2024-03-15"
output:
  ioslides_presentation
---
```{r,echo=FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(dplyr)
library(tidyr)
library(caret)
library(stringr)
library(randomForest)
library(e1071)
library(gbm)

```

## Background and the Problem
- The dataset we used has information regarding the top 50 tracks of 2023 on Spotify from kaggle.com
- There are 12 variables measured regarding the tracks found in the dataset: danceability, valence, energy, loudness, acousticness, instrumentalness, liveness, speechiness, tempo, duration_ms, time_signature, popularity
- The main question we would like to answer regarding this data is Can we predict what attributes caused these tracks to be the most popular of 2023? To answer this, we have separated it into 3 parts:
     - What are the most common genres among the top tracks?
     - What is the correlation between track attributes and popularity?
     - Can we predict track popularity based on these features?

## Our data

df<- read.csv("top_50_2023.csv", sep=",", header=TRUE)


```{r,echo=FALSE,}
df<- read.csv("top_50_2023.csv", sep=",", header=TRUE)

```


```{r,echo=FALSE,eval=FALSE}
##cleaning 
###xxxxxxxxx
#select Variables 

df %>%
  select(artist_name,track_name,popularity) 
##xxxxxxxxxxxx
##filter observations 

df %>%
  select(artist_name,track_name,popularity) 
na.omit()
#conclusion no missing data 
class(df$genres)
levels(df$genres)
df$genres<-as.factor(df$genres)
class(df$genres)
levels(df$genres)

###duck with the data 

class(df$genres)
levels(df$genres)
df <- separate_rows(df, genres, sep = ", ")


genre <- "rap"  # Specify the genre for which you want to list track names
rap_songs <- df[df$genres == "", "track_name"]
print(rap_songs)
df %>%
  select(artist_name,genres) 

# Split genres and create a separate row for each genre while preserving song and artist information
df <- df %>%
  mutate(genres = str_split(genres, ", ")) %>%
  unnest(genres)
df %>%
  select(artist_name,genres) 
##################


```



```{r,echo=FALSE,eval=FALSE}
### work 
class(df$is_explicit)
unique(df$is_explicit)
df$is_explicit<- as.factor(df$is_explicit)
class(df$is_explicit)
levels(df$is_explicit)
df$is_explicit <- factor((df$is_explicit),levels = c("True","False"))
levels(df$is_explicit)
df$genres <- gsub("\\[|'|\\]", "", df$genres)

df %>%
  select(artist_name,track_name,popularity,genres) 
# Arrange the dataframe in descending order based on the 'popularity' column
df <- arrange(df, desc(popularity))

# View the arranged dataframe
print(df)
```

## What are the most common genres among the top tracks?
```{r,echo=FALSE}
# Analyzing common genres among top tracks

# Assuming your dataset is named 'spotify_top_tracks_2023'

# Check the structure of the dataset
##str(df)
df$genres <- gsub("\\[|'|\\]", "", df$genres)

# Count the occurrences of each genre
genre_counts <- table(unlist(df$genres))

# Sort the genres by frequency
sorted_genres <- sort(genre_counts, decreasing = TRUE)

# Display the top N most common genres
N <- 5  # You can adjust this value as needed
top_genres <- head(sorted_genres, N)

# Create a data frame for plotting
genre_data <- data.frame(genre = names(top_genres), frequency = as.numeric(top_genres))

# Plot using ggplot2
ggplot(genre_data, aes(x = reorder(genre, -frequency), y = frequency)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Top 5 Most Common Genres Among Top Tracks",
       x = "Genre", y = "Frequency") +
  theme(axis.text.x = element_text(angle = 0, hjust = 1))  # Rotate x-axis labels
# Count the occurrences of each genre
genre_counts <- df %>% 
  count(genres) %>%
  arrange(desc(n))  # Arrange in descending order of frequency

# Display the top 10 most common genres
top_genres <- head(genre_counts, 10)
print(top_genres)

```
